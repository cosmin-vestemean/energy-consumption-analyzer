<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Technical Formulas & Analysis - Electric Consumption Analyzer</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, sans-serif;
            background: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%);
            padding: 20px;
            line-height: 1.6;
            color: #333;
        }

        .container {
            max-width: 900px;
            margin: 0 auto;
            background: white;
            padding: 40px;
            border-radius: 12px;
            box-shadow: 0 10px 40px rgba(0, 0, 0, 0.1);
        }

        .nav-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 30px;
            padding-bottom: 20px;
            border-bottom: 2px solid #667eea;
        }

        .back-button {
            background: #667eea;
            color: white;
            padding: 10px 20px;
            border-radius: 8px;
            text-decoration: none;
            transition: background 0.3s;
            font-weight: 500;
        }

        .back-button:hover {
            background: #5568d3;
        }

        .home-button {
            background: #00C49F;
            color: white;
            padding: 10px 20px;
            border-radius: 8px;
            text-decoration: none;
            transition: background 0.3s;
            font-weight: 500;
        }

        .home-button:hover {
            background: #00a885;
        }

        h1 {
            color: #667eea;
            margin-bottom: 10px;
            font-size: 2.5em;
        }

        h2 {
            color: #667eea;
            margin-top: 30px;
            margin-bottom: 15px;
            font-size: 1.8em;
            border-bottom: 2px solid #e0e0e0;
            padding-bottom: 10px;
        }

        h3 {
            color: #764ba2;
            margin-top: 25px;
            margin-bottom: 12px;
            font-size: 1.4em;
        }

        h4 {
            color: #555;
            margin-top: 20px;
            margin-bottom: 10px;
            font-size: 1.1em;
        }

        p {
            margin-bottom: 15px;
            line-height: 1.8;
        }

        ul, ol {
            margin-left: 25px;
            margin-bottom: 15px;
        }

        li {
            margin-bottom: 8px;
        }

        code {
            background: #f5f5f5;
            padding: 2px 6px;
            border-radius: 4px;
            font-family: 'Courier New', monospace;
            font-size: 0.9em;
            color: #c7254e;
        }

        pre {
            background: #f5f5f5;
            padding: 15px;
            border-radius: 8px;
            overflow-x: auto;
            margin: 20px 0;
            border-left: 4px solid #667eea;
        }

        pre code {
            background: none;
            padding: 0;
            color: #333;
        }

        table {
            width: 100%;
            border-collapse: collapse;
            margin: 20px 0;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
        }

        th, td {
            padding: 12px;
            text-align: left;
            border-bottom: 1px solid #e0e0e0;
        }

        th {
            background: #667eea;
            color: white;
            font-weight: 600;
        }

        tr:hover {
            background: #f9f9f9;
        }

        blockquote {
            border-left: 4px solid #00C49F;
            padding-left: 20px;
            margin: 20px 0;
            color: #666;
            font-style: italic;
        }

        strong {
            color: #667eea;
            font-weight: 600;
        }

        a {
            color: #667eea;
            text-decoration: none;
        }

        a:hover {
            text-decoration: underline;
        }

        hr {
            border: none;
            border-top: 2px solid #e0e0e0;
            margin: 30px 0;
        }

        .warning {
            background: #fff3cd;
            border-left: 4px solid #ffc107;
            padding: 15px;
            margin: 20px 0;
            border-radius: 4px;
        }

        .info {
            background: #d1ecf1;
            border-left: 4px solid #0c5460;
            padding: 15px;
            margin: 20px 0;
            border-radius: 4px;
        }

        .success {
            background: #d4edda;
            border-left: 4px solid #28a745;
            padding: 15px;
            margin: 20px 0;
            border-radius: 4px;
        }

        @media print {
            body {
                background: white;
            }
            .nav-header {
                display: none;
            }
            .container {
                box-shadow: none;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="nav-header">
            <a href="index.html" class="back-button">
                ← Documentation Hub
            </a>
            <a href="javascript:window.close()" class="home-button">Close Documentation</a>
        </div>
        <h1>Electric Consumption Analyzer - Technical Analysis &amp; Formulas</h1>
<p><strong>Document Version:</strong> 1.0<br><strong>Date:</strong> October 20, 2025<br><strong>Application:</strong> Electric Consumption Analyzer for PV System Design</p>
<hr>
<h2>Table of Contents</h2>
<ol>
<li><a href="#overview">Overview</a></li>
<li><a href="#data-processing">Data Processing</a></li>
<li><a href="#statistical-analysis">Statistical Analysis</a></li>
<li><a href="#consumption-pattern-analysis">Consumption Pattern Analysis</a></li>
<li><a href="#pv-system-sizing-calculations">PV System Sizing Calculations</a></li>
<li><a href="#financial-analysis">Financial Analysis</a></li>
<li><a href="#assumptions--constants">Assumptions &amp; Constants</a></li>
</ol>
<hr>
<h2>Overview</h2>
<p>This document provides complete transparency on all calculations, formulas, and methodologies used in the Electric Consumption Analyzer application. The system analyzes hourly/daily energy consumption data to provide comprehensive statistics and photovoltaic (PV) system recommendations.</p>
<hr>
<h2>Data Processing</h2>
<h3>Input Data Format</h3>
<p>The application accepts Excel files with the following columns:</p>
<ul>
<li><strong>energie (kwh)</strong>: Energy consumption in kilowatt-hours</li>
<li><strong>ora</strong>: Hour of day (0-23)</li>
<li><strong>zi</strong>: Day of month (1-31)</li>
<li><strong>luna</strong>: Month (1-12)</li>
</ul>
<h3>Data Validation</h3>
<p>Each data point is validated against the following criteria:</p>
<pre><code>✓ energie ≥ 0 (allows zero consumption)
✓ 0 ≤ ora ≤ 23
✓ 1 ≤ zi ≤ 31
✓ 1 ≤ luna ≤ 12
</code></pre>
<p><strong>Data Handling:</strong></p>
<ul>
<li>Zero consumption values are retained (important for nighttime readings)</li>
<li>Invalid or incomplete rows are filtered out</li>
<li>All valid data points are included in calculations</li>
</ul>
<hr>
<h2>Statistical Analysis</h2>
<h3>1. Basic Statistics</h3>
<h4>Total Consumption</h4>
<pre><code>Total Consumption = Σ(energie_i) for all i data points

Where:
  energie_i = energy consumption at reading i
</code></pre>
<h4>Average Hourly Consumption</h4>
<pre><code>Average Hourly Consumption = Total Consumption / Number of Data Points

Formula: avg = Σ(E_i) / n

Where:
  E_i = energy value at reading i
  n = total number of readings
</code></pre>
<h4>Maximum &amp; Minimum Consumption</h4>
<pre><code>Maximum Consumption = max(energie_i) for all i
Minimum Consumption = min(energie_i) for all i
</code></pre>
<h3>2. Hourly Statistics</h3>
<p>For each hour h (0-23):</p>
<pre><code>Hourly Average(h) = Σ(E_h,i) / n_h

Hourly Maximum(h) = max(E_h,i)

Hourly Minimum(h) = min(E_h,i)

Where:
  E_h,i = energy consumption at hour h for occurrence i
  n_h = number of readings at hour h
</code></pre>
<h3>3. Daily Statistics</h3>
<pre><code>Daily Total(d) = Σ(energie_i) for all readings on day d

Daily Average = Σ(Daily Total_d) / Number of Days

Daily Maximum = max(Daily Total_d)

Daily Minimum = min(Daily Total_d)

Where:
  d = unique day identifier (day-month combination)
</code></pre>
<hr>
<h2>Consumption Pattern Analysis</h2>
<h3>1. Peak vs Off-Peak Analysis</h3>
<p><strong>Peak Hours Definition:</strong> 10:00 - 19:00 (10 AM - 7 PM)<br><strong>Off-Peak Hours Definition:</strong> 00:00 - 06:00, 22:00 - 23:00 (12 AM - 6 AM, 10 PM - 11 PM)</p>
<pre><code>Peak Average = Σ(E_peak) / n_peak

Off-Peak Average = Σ(E_off-peak) / n_off-peak

Peak-to-Off-Peak Ratio = Peak Average / Off-Peak Average

Where:
  E_peak = energy consumption during peak hours
  E_off-peak = energy consumption during off-peak hours
  n_peak = number of peak readings
  n_off-peak = number of off-peak readings
</code></pre>
<h3>2. Load Factor</h3>
<p>Load factor indicates how efficiently the energy system is utilized:</p>
<pre><code>Load Factor = (Average Consumption / Peak Consumption) × 100%

Formula: LF = (P_avg / P_max) × 100

Where:
  P_avg = average hourly consumption
  P_max = maximum hourly consumption

Interpretation:
  LF &gt; 70%: High and consistent energy usage (efficient)
  40% &lt; LF ≤ 70%: Moderate usage with some peaks
  LF ≤ 40%: High variability, peak-dominated usage
</code></pre>
<h3>3. Consumption Variability</h3>
<h4>Variance</h4>
<pre><code>Variance = Σ((E_i - μ)²) / n

Where:
  E_i = energy value at reading i
  μ = mean (average) consumption
  n = total number of readings
</code></pre>
<h4>Standard Deviation</h4>
<pre><code>Standard Deviation (σ) = √Variance

σ = √[Σ((E_i - μ)²) / n]
</code></pre>
<h4>Coefficient of Variation (CV)</h4>
<pre><code>Coefficient of Variation = (σ / μ) × 100%

Interpretation:
  CV &gt; 100%: Very high variability
  50% &lt; CV ≤ 100%: Moderate variability
  CV ≤ 50%: Low variability, consistent usage
</code></pre>
<h3>4. Consumption Distribution</h3>
<p>Data is categorized into consumption ranges:</p>
<ul>
<li>0-1 kWh</li>
<li>1-5 kWh</li>
<li>5-10 kWh</li>
<li>10-20 kWh</li>
<li>20-30 kWh</li>
<li>30+ kWh</li>
</ul>
<pre><code>Percentage in Range = (Count in Range / Total Readings) × 100%
</code></pre>
<hr>
<h2>PV System Sizing Calculations</h2>
<h3>Assumptions &amp; Constants</h3>
<pre><code>System Efficiency (η_sys) = 0.85 (85%)
Panel Wattage (P_panel) = 400 W
Peak Sun Hours (PSH) = 4.5 hours/day
Autonomy Days (D_auto) = 2 days
Battery Efficiency (η_bat) = 0.9 (90%)
Battery Cycle Life = 5000 cycles
Inverter Safety Margin = 1.2 (20% oversizing)
</code></pre>
<h3>1. Solar Array Sizing</h3>
<h4>Required PV Array Capacity</h4>
<pre><code>PV Array Size (kW) = (Daily Energy Need / Peak Sun Hours) / System Efficiency

Formula: P_pv = (E_daily / PSH) / η_sys

Where:
  E_daily = average daily consumption (kWh)
  PSH = peak sun hours per day (hours)
  η_sys = overall system efficiency (0.85)

Example:
  If E_daily = 30 kWh
  P_pv = (30 / 4.5) / 0.85 = 7.84 kW
</code></pre>
<h4>Number of Solar Panels</h4>
<pre><code>Number of Panels = ⌈(PV Array Size × 1000) / Panel Wattage⌉

Formula: N_panels = ⌈(P_pv × 1000) / P_panel⌉

Where:
  ⌈ ⌉ = ceiling function (round up)
  P_pv = PV array size in kW
  P_panel = individual panel wattage (400W)

Example:
  N_panels = ⌈(7.84 × 1000) / 400⌉ = ⌈19.6⌉ = 20 panels
</code></pre>
<h3>2. Battery Storage Sizing</h3>
<pre><code>Battery Capacity (kWh) = (Daily Energy Need × Autonomy Days) / Battery Efficiency

Formula: C_bat = (E_daily × D_auto) / η_bat

Where:
  E_daily = average daily consumption (kWh)
  D_auto = days of autonomy (2 days)
  η_bat = battery round-trip efficiency (0.9)

Example:
  If E_daily = 30 kWh
  C_bat = (30 × 2) / 0.9 = 66.67 kWh
</code></pre>
<p><strong>Note:</strong> 2 days of autonomy provides backup power during cloudy weather or system maintenance.</p>
<h3>3. Inverter Sizing</h3>
<pre><code>Inverter Size (kW) = Peak Power Need × Safety Margin

Formula: P_inv = P_peak × 1.2

Where:
  P_peak = maximum hourly consumption (kW)
  1.2 = 20% safety margin for surge loads

Example:
  If P_peak = 5 kW
  P_inv = 5 × 1.2 = 6 kW
</code></pre>
<h3>4. Annual Energy Production</h3>
<pre><code>Annual Production = PV Array Size × Peak Sun Hours × Days per Year

Formula: E_annual = P_pv × PSH × 365

Example:
  E_annual = 7.84 × 4.5 × 365 = 12,878 kWh/year
</code></pre>
<h3>5. Energy Offset Percentage</h3>
<pre><code>Energy Offset = min((Annual Production / Annual Consumption) × 100%, 100%)

Formula: Offset = min((E_annual / E_consumption) × 100%, 100%)

Where:
  E_consumption = daily consumption × 365
</code></pre>
<hr>
<h2>Financial Analysis</h2>
<h3>Cost Components</h3>
<h4>Equipment Costs</h4>
<pre><code>Panel Cost = Number of Panels × Panel Wattage × Cost per Watt
           = N_panels × P_panel × €0.80/W

Battery Cost = Battery Capacity × Cost per kWh
             = C_bat × €400/kWh

Inverter Cost = Inverter Size × Cost per kW
              = P_inv × €300/kW
</code></pre>
<h4>Total System Cost</h4>
<pre><code>Equipment Cost = Panel Cost + Battery Cost + Inverter Cost

Installation Cost = Equipment Cost × 0.3 (30% for installation)

Total System Cost = Equipment Cost × 1.3

Where:
  1.3 = installation multiplier (equipment + 30% installation)
</code></pre>
<h3>Return on Investment (ROI)</h3>
<h4>Annual Savings</h4>
<pre><code>Annual Savings = Daily Energy × 365 × Electricity Rate × Energy Offset

Formula: S_annual = E_daily × 365 × €0.25/kWh × (Offset/100)

Assumptions:
  Electricity Rate = €0.25/kWh (average European rate)
</code></pre>
<h4>Payback Period</h4>
<pre><code>Payback Period (years) = Total System Cost / Annual Savings

Formula: T_payback = C_total / S_annual

Example:
  If C_total = €20,000 and S_annual = €2,500
  T_payback = 20,000 / 2,500 = 8 years
</code></pre>
<h4>25-Year Return on Investment</h4>
<pre><code>25-Year ROI = ((Annual Savings × 25) / Total System Cost - 1) × 100%

Formula: ROI_25 = ((S_annual × 25) / C_total - 1) × 100%

Example:
  ROI_25 = ((2,500 × 25) / 20,000 - 1) × 100% = 212.5%
</code></pre>
<hr>
<h2>System Sizing Options</h2>
<p>The application provides three system sizing strategies:</p>
<h3>1. Conservative System (80% Coverage)</h3>
<pre><code>PV Array: Base PV Size × 0.8
Panels: Base Panels × 0.8
Battery: Base Battery × 0.6
Total Cost: Base Cost × 0.75
Energy Offset: Base Offset × 0.8
</code></pre>
<p><strong>Use Case:</strong> Lower upfront cost, grid backup required, urban areas with reliable grid</p>
<h3>2. Optimal System (100% Coverage)</h3>
<pre><code>PV Array: Base PV Size × 1.0
Panels: Base Panels × 1.0
Battery: Base Battery × 1.0
Total Cost: Base Cost × 1.0
Energy Offset: Base Offset × 1.0
</code></pre>
<p><strong>Use Case:</strong> Balanced approach, maximum self-consumption, typical residential installation</p>
<h3>3. Aggressive System (130% Coverage)</h3>
<pre><code>PV Array: Base PV Size × 1.3
Panels: Base Panels × 1.3
Battery: Base Battery × 1.2
Total Cost: Base Cost × 1.4
Energy Offset: min(Base Offset × 1.3, 100%)
</code></pre>
<p><strong>Use Case:</strong> Future-proof, supports EV charging, allows system expansion, off-grid capable</p>
<hr>
<h2>Cost Breakdown Distribution</h2>
<p>Typical cost distribution for the optimal system:</p>
<pre><code>Solar Panels: ~50-55% of total cost
Battery Storage: ~30-35% of total cost
Inverter: ~8-12% of total cost
Installation &amp; Wiring: ~23% of total cost (30% of equipment cost)
</code></pre>
<hr>
<h2>Data Aggregation for Visualization</h2>
<h3>Large Datasets (&gt; 1000 data points)</h3>
<p>For performance optimization with yearly data:</p>
<pre><code>Daily Average = Σ(E_hourly) / 24

Where data is grouped by day-month combination and averaged
</code></pre>
<h3>Small Datasets (≤ 1000 data points)</h3>
<p>All hourly data points are displayed without aggregation.</p>
<hr>
<h2>Quality Metrics &amp; Interpretations</h2>
<h3>Load Factor Interpretation</h3>
<table>
<thead>
<tr>
<th>Load Factor</th>
<th>Interpretation</th>
<th>System Impact</th>
</tr>
</thead>
<tbody><tr>
<td>&gt; 70%</td>
<td>High, consistent usage</td>
<td>Efficient system utilization</td>
</tr>
<tr>
<td>40-70%</td>
<td>Moderate variability</td>
<td>Standard residential pattern</td>
</tr>
<tr>
<td>&lt; 40%</td>
<td>High peak demand</td>
<td>Requires larger inverter</td>
</tr>
</tbody></table>
<h3>Coefficient of Variation Interpretation</h3>
<table>
<thead>
<tr>
<th>CV Value</th>
<th>Variability</th>
<th>Design Consideration</th>
</tr>
</thead>
<tbody><tr>
<td>&gt; 100%</td>
<td>Very high</td>
<td>Robust system with oversizing</td>
</tr>
<tr>
<td>50-100%</td>
<td>Moderate</td>
<td>Standard safety margins</td>
</tr>
<tr>
<td>&lt; 50%</td>
<td>Low</td>
<td>Optimized system possible</td>
</tr>
</tbody></table>
<h3>Peak-to-Off-Peak Ratio Interpretation</h3>
<table>
<thead>
<tr>
<th>Ratio</th>
<th>Pattern</th>
<th>Recommendation</th>
</tr>
</thead>
<tbody><tr>
<td>&gt; 5.0</td>
<td>Very high daytime use</td>
<td>Excellent for PV</td>
</tr>
<tr>
<td>2.0-5.0</td>
<td>Normal residential</td>
<td>Standard PV suitable</td>
</tr>
<tr>
<td>&lt; 2.0</td>
<td>Evening/night heavy</td>
<td>Larger battery needed</td>
</tr>
</tbody></table>
<hr>
<h2>Validation &amp; Quality Assurance</h2>
<h3>Data Quality Checks</h3>
<ol>
<li><strong>Completeness:</strong> Verify all required fields present</li>
<li><strong>Range Validation:</strong> Ensure values within physical limits</li>
<li><strong>Consistency:</strong> Check for temporal continuity</li>
<li><strong>Outliers:</strong> Identify extreme values for review</li>
</ol>
<h3>Calculation Verification</h3>
<p>All formulas are based on:</p>
<ul>
<li>IEEE standards for PV system design</li>
<li>IEC 61724 (PV system performance monitoring)</li>
<li>Industry best practices for energy system sizing</li>
<li>European regulatory guidelines (where applicable)</li>
</ul>
<hr>
<h2>Technical References</h2>
<h3>Standards &amp; Guidelines</h3>
<ul>
<li>IEC 61724: Photovoltaic system performance monitoring</li>
<li>IEC 61853: Photovoltaic module performance testing</li>
<li>IEEE 1562: Guide for Array and Battery Sizing in Stand-Alone PV Systems</li>
<li>EN 50438: Grid connection requirements</li>
</ul>
<h3>Engineering Assumptions Basis</h3>
<ul>
<li>System efficiency (85%): Accounts for inverter losses, wiring losses, temperature derating, soiling</li>
<li>Peak sun hours (4.5h): Based on average European solar irradiation</li>
<li>Battery efficiency (90%): Typical for modern lithium-ion battery systems</li>
<li>Component costs: Based on 2024-2025 market averages</li>
</ul>
<hr>
<h2>Disclaimer</h2>
<p>This analysis tool provides <strong>preliminary estimates</strong> for educational and planning purposes. Actual system design should be performed by qualified engineers considering:</p>
<ul>
<li>Local solar irradiation data</li>
<li>Site-specific conditions (shading, roof orientation, structural capacity)</li>
<li>Local building codes and regulations</li>
<li>Grid connection requirements</li>
<li>Available incentives and subsidies</li>
<li>Detailed load analysis including surge requirements</li>
<li>Environmental factors (temperature, humidity, weather patterns)</li>
</ul>
<p><strong>Professional consultation is recommended before making investment decisions.</strong></p>
<hr>
<h2>Document Control</h2>
<table>
<thead>
<tr>
<th>Version</th>
<th>Date</th>
<th>Author</th>
<th>Changes</th>
</tr>
</thead>
<tbody><tr>
<td>1.0</td>
<td>2025-10-20</td>
<td>System Generated</td>
<td>Initial documentation</td>
</tr>
</tbody></table>
<hr>
<h2>Contact &amp; Support</h2>
<p>For questions about calculations or methodologies, please contact your technical representative.</p>
<p><strong>Application URL:</strong> <a href="https://ubiquitous-orbit-wvp4rxqq66wfgw5q-3001.app.github.dev/">https://ubiquitous-orbit-wvp4rxqq66wfgw5q-3001.app.github.dev/</a></p>
<hr>
<p><em>This document is automatically maintained and synchronized with the application codebase.</em></p>

    </div>
</body>
</html>