<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Technical Formulas - Energy Consumption Analyzer</title>
    <link rel="stylesheet" href="docs-style.css">
</head>
<body>
    <div class="header-bar">
        <div class="nav-header">
            <div class="page-title">üî¨ Technical Formulas</div>
            <div class="nav-buttons">
                <a href="/docs/index.html" class="home-button">üìö Documentation Hub</a>
                <a href="javascript:window.close()" class="back-button">‚Üê Back</a>
            </div>
        </div>
    </div>

    <div class="container">
        <div class="doc-content">

<h1>Electric Consumption Analyzer - Technical Analysis &amp; Formulas</h1>
<p><strong>Document Version:</strong> 1.0<br><strong>Date:</strong> October 20, 2025<br><strong>Application:</strong> Electric Consumption Analyzer for PV System Design</p>
<hr>
<h2>Table of Contents</h2>
<ol>
<li><a href="#overview">Overview</a></li>
<li><a href="#data-processing">Data Processing</a></li>
<li><a href="#statistical-analysis">Statistical Analysis</a></li>
<li><a href="#consumption-pattern-analysis">Consumption Pattern Analysis</a></li>
<li><a href="#pv-system-sizing-calculations">PV System Sizing Calculations</a></li>
<li><a href="#financial-analysis">Financial Analysis</a></li>
<li><a href="#assumptions--constants">Assumptions &amp; Constants</a></li>
</ol>
<hr>
<h2>Overview</h2>
<p>This document provides complete transparency on all calculations, formulas, and methodologies used in the Electric Consumption Analyzer application. The system analyzes hourly/daily energy consumption data to provide comprehensive statistics and photovoltaic (PV) system recommendations.</p>
<hr>
<h2>Data Processing</h2>
<h3>Input Data Format</h3>
<p>The application accepts Excel files with the following columns:</p>
<ul>
<li><strong>energie (kwh)</strong>: Energy consumption in kilowatt-hours</li>
<li><strong>ora</strong>: Hour of day (0-23)</li>
<li><strong>zi</strong>: Day of month (1-31)</li>
<li><strong>luna</strong>: Month (1-12)</li>
</ul>
<h3>Data Validation</h3>
<p>Each data point is validated against the following criteria:</p>
<pre><code>√î≈•√¥ energie √î√´ƒÖ 0 (allows zero consumption)
√î≈•√¥ 0 √î√´ƒÑ ora √î√´ƒÑ 23
√î≈•√¥ 1 √î√´ƒÑ zi √î√´ƒÑ 31
√î≈•√¥ 1 √î√´ƒÑ luna √î√´ƒÑ 12
</code></pre>
<p><strong>Data Handling:</strong></p>
<ul>
<li>Zero consumption values are retained (important for nighttime readings)</li>
<li>Invalid or incomplete rows are filtered out</li>
<li>All valid data points are included in calculations</li>
</ul>
<hr>
<h2>Statistical Analysis</h2>
<h3>1. Basic Statistics</h3>
<h4>Total Consumption</h4>
<pre><code>Total Consumption = ‚ï¨√∫(energie_i) for all i data points

Where:
  energie_i = energy consumption at reading i
</code></pre>
<h4>Average Hourly Consumption</h4>
<pre><code>Average Hourly Consumption = Total Consumption / Number of Data Points

Formula: avg = ‚ï¨√∫(E_i) / n

Where:
  E_i = energy value at reading i
  n = total number of readings
</code></pre>
<h4>Maximum &amp; Minimum Consumption</h4>
<pre><code>Maximum Consumption = max(energie_i) for all i
Minimum Consumption = min(energie_i) for all i
</code></pre>
<h3>2. Hourly Statistics</h3>
<p>For each hour h (0-23):</p>
<pre><code>Hourly Average(h) = ‚ï¨√∫(E_h,i) / n_h

Hourly Maximum(h) = max(E_h,i)

Hourly Minimum(h) = min(E_h,i)

Where:
  E_h,i = energy consumption at hour h for occurrence i
  n_h = number of readings at hour h
</code></pre>
<h3>3. Daily Statistics</h3>
<pre><code>Daily Total(d) = ‚ï¨√∫(energie_i) for all readings on day d

Daily Average = ‚ï¨√∫(Daily Total_d) / Number of Days

Daily Maximum = max(Daily Total_d)

Daily Minimum = min(Daily Total_d)

Where:
  d = unique day identifier (day-month combination)
</code></pre>
<hr>
<h2>Consumption Pattern Analysis</h2>
<h3>1. Peak vs Off-Peak Analysis</h3>
<p><strong>Peak Hours Definition:</strong> 10:00 - 19:00 (10 AM - 7 PM)<br><strong>Off-Peak Hours Definition:</strong> 00:00 - 06:00, 22:00 - 23:00 (12 AM - 6 AM, 10 PM - 11 PM)</p>
<pre><code>Peak Average = ‚ï¨√∫(E_peak) / n_peak

Off-Peak Average = ‚ï¨√∫(E_off-peak) / n_off-peak

Peak-to-Off-Peak Ratio = Peak Average / Off-Peak Average

Where:
  E_peak = energy consumption during peak hours
  E_off-peak = energy consumption during off-peak hours
  n_peak = number of peak readings
  n_off-peak = number of off-peak readings
</code></pre>
<h3>2. Load Factor</h3>
<p>Load factor indicates how efficiently the energy system is utilized:</p>
<pre><code>Load Factor = (Average Consumption / Peak Consumption) √ó 100%

Formula: LF = (P_avg / P_max) √ó 100

Where:
  P_avg = average hourly consumption
  P_max = maximum hourly consumption

Interpretation:
  LF &gt; 70%: High and consistent energy usage (efficient)
  40% &lt; LF √î√´ƒÑ 70%: Moderate usage with some peaks
  LF √î√´ƒÑ 40%: High variability, peak-dominated usage
</code></pre>
<h3>3. Consumption Variability</h3>
<h4>Variance</h4>
<pre><code>Variance = ‚ï¨√∫((E_i - Œº)‚î¨‚ñì) / n

Where:
  E_i = energy value at reading i
  Œº = mean (average) consumption
  n = total number of readings
</code></pre>
<h4>Standard Deviation</h4>
<pre><code>Standard Deviation (œÉ) = √î≈Ç√úVariance

œÉ = √î≈Ç√ú[‚ï¨√∫((E_i - Œº)‚î¨‚ñì) / n]
</code></pre>
<h4>Coefficient of Variation (CV)</h4>
<pre><code>Coefficient of Variation = (œÉ / Œº) √ó 100%

Interpretation:
  CV &gt; 100%: Very high variability
  50% &lt; CV √î√´ƒÑ 100%: Moderate variability
  CV √î√´ƒÑ 50%: Low variability, consistent usage
</code></pre>
<h3>4. Consumption Distribution</h3>
<p>Data is categorized into consumption ranges:</p>
<ul>
<li>0-1 kWh</li>
<li>1-5 kWh</li>
<li>5-10 kWh</li>
<li>10-20 kWh</li>
<li>20-30 kWh</li>
<li>30+ kWh</li>
</ul>
<pre><code>Percentage in Range = (Count in Range / Total Readings) √ó 100%
</code></pre>
<hr>
<h2>PV System Sizing Calculations</h2>
<h3>Assumptions &amp; Constants</h3>
<pre><code>System Efficiency (‚ï¨ƒö_sys) = 0.85 (85%)
Panel Wattage (P_panel) = 400 W
Peak Sun Hours (PSH) = 4.5 hours/day
Autonomy Days (D_auto) = 2 days
Battery Efficiency (‚ï¨ƒö_bat) = 0.9 (90%)
Battery Cycle Life = 5000 cycles
Inverter Safety Margin = 1.2 (20% oversizing)
</code></pre>
<h3>1. Solar Array Sizing</h3>
<h4>Required PV Array Capacity</h4>
<pre><code>PV Array Size (kW) = (Daily Energy Need / Peak Sun Hours) / System Efficiency

Formula: P_pv = (E_daily / PSH) / ‚ï¨ƒö_sys

Where:
  E_daily = average daily consumption (kWh)
  PSH = peak sun hours per day (hours)
  ‚ï¨ƒö_sys = overall system efficiency (0.85)

Example:
  If E_daily = 30 kWh
  P_pv = (30 / 4.5) / 0.85 = 7.84 kW
</code></pre>
<h4>Number of Solar Panels</h4>
<pre><code>Number of Panels = ‚åà(PV Array Size √ó 1000) / Panel Wattage‚åâ

Formula: N_panels = ‚åà(P_pv √ó 1000) / P_panel‚åâ

Where:
  ‚åà ‚åâ = ceiling function (round up)
  P_pv = PV array size in kW
  P_panel = individual panel wattage (400W)

Example:
  N_panels = ‚åà(7.84 √ó 1000) / 400‚åâ = ‚åà19.6‚åâ = 20 panels
</code></pre>
<h3>2. Battery Storage Sizing</h3>
<pre><code>Battery Capacity (kWh) = (Daily Energy Need √ó Autonomy Days) / Battery Efficiency

Formula: C_bat = (E_daily √ó D_auto) / ‚ï¨ƒö_bat

Where:
  E_daily = average daily consumption (kWh)
  D_auto = days of autonomy (2 days)
  ‚ï¨ƒö_bat = battery round-trip efficiency (0.9)

Example:
  If E_daily = 30 kWh
  C_bat = (30 √ó 2) / 0.9 = 66.67 kWh
</code></pre>
<p><strong>Note:</strong> 2 days of autonomy provides backup power during cloudy weather or system maintenance.</p>
<h3>3. Inverter Sizing</h3>
<pre><code>Inverter Size (kW) = Peak Power Need √ó Safety Margin

Formula: P_inv = P_peak √ó 1.2

Where:
  P_peak = maximum hourly consumption (kW)
  1.2 = 20% safety margin for surge loads

Example:
  If P_peak = 5 kW
  P_inv = 5 √ó 1.2 = 6 kW
</code></pre>
<h3>4. Annual Energy Production</h3>
<pre><code>Annual Production = PV Array Size √ó Peak Sun Hours √ó Days per Year

Formula: E_annual = P_pv √ó PSH √ó 365

Example:
  E_annual = 7.84 √ó 4.5 √ó 365 = 12,878 kWh/year
</code></pre>
<h3>5. Energy Offset Percentage</h3>
<pre><code>Energy Offset = min((Annual Production / Annual Consumption) √ó 100%, 100%)

Formula: Offset = min((E_annual / E_consumption) √ó 100%, 100%)

Where:
  E_consumption = daily consumption √ó 365
</code></pre>
<hr>
<h2>Financial Analysis</h2>
<h3>Cost Components</h3>
<h4>Equipment Costs</h4>
<pre><code>Panel Cost = Number of Panels √ó Panel Wattage √ó Cost per Watt
           = N_panels √ó P_panel √ó ‚Ç¨0.80/W

Battery Cost = Battery Capacity √ó Cost per kWh
             = C_bat √ó ‚Ç¨400/kWh

Inverter Cost = Inverter Size √ó Cost per kW
              = P_inv √ó ‚Ç¨300/kW
</code></pre>
<h4>Total System Cost</h4>
<pre><code>Equipment Cost = Panel Cost + Battery Cost + Inverter Cost

Installation Cost = Equipment Cost √ó 0.3 (30% for installation)

Total System Cost = Equipment Cost √ó 1.3

Where:
  1.3 = installation multiplier (equipment + 30% installation)
</code></pre>
<h3>Return on Investment (ROI)</h3>
<h4>Annual Savings</h4>
<pre><code>Annual Savings = Daily Energy √ó 365 √ó Electricity Rate √ó Energy Offset

Formula: S_annual = E_daily √ó 365 √ó ‚Ç¨0.25/kWh √ó (Offset/100)

Assumptions:
  Electricity Rate = ‚Ç¨0.25/kWh (average European rate)
</code></pre>
<h4>Payback Period</h4>
<pre><code>Payback Period (years) = Total System Cost / Annual Savings

Formula: T_payback = C_total / S_annual

Example:
  If C_total = ‚Ç¨20,000 and S_annual = ‚Ç¨2,500
  T_payback = 20,000 / 2,500 = 8 years
</code></pre>
<h4>25-Year Return on Investment</h4>
<pre><code>25-Year ROI = ((Annual Savings √ó 25) / Total System Cost - 1) √ó 100%

Formula: ROI_25 = ((S_annual √ó 25) / C_total - 1) √ó 100%

Example:
  ROI_25 = ((2,500 √ó 25) / 20,000 - 1) √ó 100% = 212.5%
</code></pre>
<hr>
<h2>System Sizing Options</h2>
<p>The application provides three system sizing strategies:</p>
<h3>1. Conservative System (80% Coverage)</h3>
<pre><code>PV Array: Base PV Size √ó 0.8
Panels: Base Panels √ó 0.8
Battery: Base Battery √ó 0.6
Total Cost: Base Cost √ó 0.75
Energy Offset: Base Offset √ó 0.8
</code></pre>
<p><strong>Use Case:</strong> Lower upfront cost, grid backup required, urban areas with reliable grid</p>
<h3>2. Optimal System (100% Coverage)</h3>
<pre><code>PV Array: Base PV Size √ó 1.0
Panels: Base Panels √ó 1.0
Battery: Base Battery √ó 1.0
Total Cost: Base Cost √ó 1.0
Energy Offset: Base Offset √ó 1.0
</code></pre>
<p><strong>Use Case:</strong> Balanced approach, maximum self-consumption, typical residential installation</p>
<h3>3. Aggressive System (130% Coverage)</h3>
<pre><code>PV Array: Base PV Size √ó 1.3
Panels: Base Panels √ó 1.3
Battery: Base Battery √ó 1.2
Total Cost: Base Cost √ó 1.4
Energy Offset: min(Base Offset √ó 1.3, 100%)
</code></pre>
<p><strong>Use Case:</strong> Future-proof, supports EV charging, allows system expansion, off-grid capable</p>
<hr>
<h2>Cost Breakdown Distribution</h2>
<p>Typical cost distribution for the optimal system:</p>
<pre><code>Solar Panels: ~50-55% of total cost
Battery Storage: ~30-35% of total cost
Inverter: ~8-12% of total cost
Installation &amp; Wiring: ~23% of total cost (30% of equipment cost)
</code></pre>
<hr>
<h2>Data Aggregation for Visualization</h2>
<h3>Large Datasets (&gt; 1000 data points)</h3>
<p>For performance optimization with yearly data:</p>
<pre><code>Daily Average = ‚ï¨√∫(E_hourly) / 24

Where data is grouped by day-month combination and averaged
</code></pre>
<h3>Small Datasets (√î√´ƒÑ 1000 data points)</h3>
<p>All hourly data points are displayed without aggregation.</p>
<hr>
<h2>Quality Metrics &amp; Interpretations</h2>
<h3>Load Factor Interpretation</h3>
<table>
<thead>
<tr>
<th>Load Factor</th>
<th>Interpretation</th>
<th>System Impact</th>
</tr>
</thead>
<tbody><tr>
<td>&gt; 70%</td>
<td>High, consistent usage</td>
<td>Efficient system utilization</td>
</tr>
<tr>
<td>40-70%</td>
<td>Moderate variability</td>
<td>Standard residential pattern</td>
</tr>
<tr>
<td>&lt; 40%</td>
<td>High peak demand</td>
<td>Requires larger inverter</td>
</tr>
</tbody></table>
<h3>Coefficient of Variation Interpretation</h3>
<table>
<thead>
<tr>
<th>CV Value</th>
<th>Variability</th>
<th>Design Consideration</th>
</tr>
</thead>
<tbody><tr>
<td>&gt; 100%</td>
<td>Very high</td>
<td>Robust system with oversizing</td>
</tr>
<tr>
<td>50-100%</td>
<td>Moderate</td>
<td>Standard safety margins</td>
</tr>
<tr>
<td>&lt; 50%</td>
<td>Low</td>
<td>Optimized system possible</td>
</tr>
</tbody></table>
<h3>Peak-to-Off-Peak Ratio Interpretation</h3>
<table>
<thead>
<tr>
<th>Ratio</th>
<th>Pattern</th>
<th>Recommendation</th>
</tr>
</thead>
<tbody><tr>
<td>&gt; 5.0</td>
<td>Very high daytime use</td>
<td>Excellent for PV</td>
</tr>
<tr>
<td>2.0-5.0</td>
<td>Normal residential</td>
<td>Standard PV suitable</td>
</tr>
<tr>
<td>&lt; 2.0</td>
<td>Evening/night heavy</td>
<td>Larger battery needed</td>
</tr>
</tbody></table>
<hr>
<h2>Validation &amp; Quality Assurance</h2>
<h3>Data Quality Checks</h3>
<ol>
<li><strong>Completeness:</strong> Verify all required fields present</li>
<li><strong>Range Validation:</strong> Ensure values within physical limits</li>
<li><strong>Consistency:</strong> Check for temporal continuity</li>
<li><strong>Outliers:</strong> Identify extreme values for review</li>
</ol>
<h3>Calculation Verification</h3>
<p>All formulas are based on:</p>
<ul>
<li>IEEE standards for PV system design</li>
<li>IEC 61724 (PV system performance monitoring)</li>
<li>Industry best practices for energy system sizing</li>
<li>European regulatory guidelines (where applicable)</li>
</ul>
<hr>
<h2>Technical References</h2>
<h3>Standards &amp; Guidelines</h3>
<ul>
<li>IEC 61724: Photovoltaic system performance monitoring</li>
<li>IEC 61853: Photovoltaic module performance testing</li>
<li>IEEE 1562: Guide for Array and Battery Sizing in Stand-Alone PV Systems</li>
<li>EN 50438: Grid connection requirements</li>
</ul>
<h3>Engineering Assumptions Basis</h3>
<ul>
<li>System efficiency (85%): Accounts for inverter losses, wiring losses, temperature derating, soiling</li>
<li>Peak sun hours (4.5h): Based on average European solar irradiation</li>
<li>Battery efficiency (90%): Typical for modern lithium-ion battery systems</li>
<li>Component costs: Based on 2024-2025 market averages</li>
</ul>
<hr>
<h2>Disclaimer</h2>
<p>This analysis tool provides <strong>preliminary estimates</strong> for educational and planning purposes. Actual system design should be performed by qualified engineers considering:</p>
<ul>
<li>Local solar irradiation data</li>
<li>Site-specific conditions (shading, roof orientation, structural capacity)</li>
<li>Local building codes and regulations</li>
<li>Grid connection requirements</li>
<li>Available incentives and subsidies</li>
<li>Detailed load analysis including surge requirements</li>
<li>Environmental factors (temperature, humidity, weather patterns)</li>
</ul>
<p><strong>Professional consultation is recommended before making investment decisions.</strong></p>
<hr>
<h2>Document Control</h2>
<table>
<thead>
<tr>
<th>Version</th>
<th>Date</th>
<th>Author</th>
<th>Changes</th>
</tr>
</thead>
<tbody><tr>
<td>1.0</td>
<td>2025-10-20</td>
<td>System Generated</td>
<td>Initial documentation</td>
</tr>
</tbody></table>
<hr>
<h2>Contact &amp; Support</h2>
<p>For questions about calculations or methodologies, please contact your technical representative.</p>
<p><strong>Application URL:</strong> <a href="https://ubiquitous-orbit-wvp4rxqq66wfgw5q-3001.app.github.dev/">https://ubiquitous-orbit-wvp4rxqq66wfgw5q-3001.app.github.dev/</a></p>
<hr>
<p><em>This document is automatically maintained and synchronized with the application codebase.</em></p>

        </div>
    </div>
</body>
</html>